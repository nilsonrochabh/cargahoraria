function buscarDatasDisponiveisAgendamentoDocumento(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;$.ajax({type:"POST",url:"./listar-datas-entrega-documento",data:{unidade:a,_token:$("#_token").val()},dataType:"json"}).done(function(a){a.map(function(a){$(".data_agend").append('<option value="'+a.data+'">'+formatarDataParaWeb(a.data)+"</option>")})}).fail(function(a){console.log(a)})}function preencherMaisInfoUnidade(a){$(".loaderComoChegar").show(),$(".comoChegar").hide(),$.ajax({url:"./info-unidade",type:"POST",dataType:"json",data:"unidade="+a+"&_token="+$("#_token").val()}).done(function(a){$(".loaderComoChegar").hide(),$(".comoChegar").show(),$(".telefoneUnidade").text(a.ds_telefone),$(".enderecoUnidade").text(a.ds_endereco_contrato),$(".nomeUnidade").text(a.nm_unidade),$(".siteUnidade").text(a.ds_url),""!=a.ds_edital_matricula&&($(".cardMatricula").show(),$(".editalMatricula").attr("href",$("#URL_EDITAIS").val()+a.ds_edital_matricula)),""!=a.ds_edital&&$(".editalBolsa").attr("href",$("#URL_EDITAIS").val()+a.ds_edital),""!=a.ds_imagem&&$(".imagemUnidade").attr("src","./public/img/escolas/"+a.ds_imagem+".jpg"),$(".siteUnidade").attr("href",a.ds_url)}).fail(function(a){console.log("error",a)})}function toggleBox(a){$(a).toggle("slow")}$(function(){$(".data").blur(function(){var a=$(this).val(),e=$("#unidade_id").val(),o="agendamento"==$(this).attr("data-origin")?".horario_agend":".horario_visita";$(o).html("<option>Aguarde...</option>"),$.ajax({url:"./listar-horarios-visita",type:"POST",dataType:"json",data:"unidade="+e+"&data="+a+"&_token="+$("#_token").val()}).done(function(a){$(o).html(""),a.forEach(function(a){$(o).append("<option value='"+a+"' >"+a+"</option>")})}).fail(function(a){console.log(a)})}),$("#nr_filhos").change(function(){var a=$(this).val();if(""!=a){for($("#boxTbodyAlunoSerie").html("");a>0;)$("#boxTbodyAlunoSerie").append("<tr><td width='50%'><input type='text' class='form-control' name='ds_alunos[]' /></td><td width='50%'><select class='form-control' name='ds_series[]' >"+seriesSelect+"</select></td></tr"),a--;$("#tabelaAlunosSerie").show(),$("#btEnviar").prop("disabled",!1)}else $("#tabelaAlunosSerie").hide(),$("#btEnviar").prop("disabled",!0)}),$("#unidade_id").change(function(){var a=$(this).val();""!=a?(preencherMaisInfoUnidade(a),$.ajax({url:"./listar-series-por-unidade",type:"POST",dataType:"json",data:{unidade:a,_token:$("#_token").val()}}).done(function(a){seriesSelect="<option value=''></option>",a.forEach(function(a){turnoAux=""!=a.ds_turno?" - "+a.ds_turno:"",seriesSelect+="<option value='"+a.id+"'>"+a.nm_serie+turnoAux+"</option>"})}).fail(function(a){console.log("error",a)}),$("#nr_filhos").prop("disabled",!1),$("#tabelaAlunosSerie").hide(),$("#boxTbodyAlunoSerie").html(""),$("#nr_filhos").val("")):($(".comoChegar").hide(),$("#nr_filhos").prop("disabled",!0))})}),$(function(){var a=$(".loader"),e=$(":submit");$(".boxRendaAcima").hide(),$(".btCadPreinscricaoEditar").click(function(){$(".boxOptions").slideUp("slow"),$("#boxPreinscricaoConsulta").fadeIn("slow"),$("#boxPreinscricao").hide()});var o;o=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()),$(".datepicker_documento").datepicker({format:"dd/mm/yyyy",minDate:o,uiLibrary:"bootstrap4"}),$("body").on("click",".btInscreverBolsaSocial",function(){var a=this,e=$(this).attr("data-aluno"),o=$(this).attr("data-serie");$(this).removeClass("btn-outline-danger"),$(this).addClass("btn-outline-warning"),$(this).removeClass("btInscreverBolsaSocial"),$(this).text("aguarde"),$.ajax({type:"POST",url:"./adicionar-aluno-bolsa-social",data:{idBolsa:$("#idBolsa").val(),_token:$("#_token").val(),aluno:e,serie:o},dataType:"json"}).done(function(e){$(a).removeClass("btInscreverBolsaSocial"),$(a).removeClass("btn-outline-warning"),$(a).addClass("btn-outline-success"),$(a).text("Já inscrito para Bolsa Social")}).fail(function(e){$(a).removeClass("btInscreverBolsaSocial"),$(a).removeClass("btn-outline-warning"),$(a).addClass("btn-outline-warning"),$(a).text("Erro, tente novamente.")})}),$("#formConsultaEmail").on("submit",function(o){o.preventDefault(),e.prop("disabled",!0),a.show(),$("#erroFormConsultaEmail").html(""),console.log($("#emailConsulta").val()),$.ajax({type:"POST",url:"./pesquisar-prematricula-por-email",data:{email:$("#emailConsulta").val(),_token:$("#_token").val()},dataType:"JSON"}).done(function(a){if(a.prematriculaInfo){$("#formConsultaEmail").slideUp("slow"),$("#boxVisitaAtu").show(),$("#idPrematricula").val(a.prematriculaInfo[0].id),$("#unidade_id").val(a.prematriculaInfo[0].unidade_id),preencherMaisInfoUnidade(a.prematriculaInfo[0].unidade_id),$("#boxMaisInfoPreinscricao").show(),$("#responsavelAtu").html(a.prematriculaInfo[0].nm_responsavel),$("#emailAtu").html(a.prematriculaInfo[0].ds_email),$("#telefone1Atu").html(a.prematriculaInfo[0].ds_celular),$("#telefone2Atu").html(a.prematriculaInfo[0].ds_celular2),$("#comoConheceuAtu").html(a.prematriculaInfo[0].ds_conheceu),$(".loginBolsa").val(a.prematriculaInfo[0].ds_email),buscarDatasDisponiveisAgendamentoDocumento(a.prematriculaInfo[0].unidade_id);var e=[];Array.isArray(a.bolsaInfo)?($("#botaoResultadoBolsaSocial").show(),a.bolsaInfo[0].serie.map(function(a){e.push(a.pivot.nm_aluno)}),$("#idBolsa").val(a.bolsaInfo[0].id),$("#boxBolsaJaInscrito").show(),$("#agendamentosRealizadosDocumento").html(""),a.bolsaInfo[0].agendamentodoc.length>0?a.bolsaInfo[0].agendamentodoc.map(function(a){$("#agendamentosRealizadosDocumento").append("<tr><td class='text-center'>"+formatarDataParaWeb(a.data)+"</td><td class='text-center'>"+formatarHorarioParaWeb(a.horario)+"</td></tr>")}):$("#agendamentosRealizadosDocumento").append("<tr><td colspan='2' class='text-center'>Nenhum registro encontrado.</td></tr>")):$(".boxBolsaSocialAtu").show();var o=void 0,t=void 0,s="";s="<table class='table table-condensed' style='font-size:12px; width:100%'><thead><tr><th class='text-center font-weight-bold'>Nome</th><th class='font-weight-bold text-center'>Série</th><th class='text-center font-weight-bold'>Situação</th></tr></thead><tbody>",a.prematriculaInfo[0].serie.map(function(a){e.length>0?(o=e.find(function(e){return e===a.pivot.ds_nome_aluno}),t=o?"<a href='javascript:;' class='btn btn-outline-success btn-sm'>Já inscrito para Bolsa Social</a>":"<a href='javascript:;' data-serie='"+a.id+"' data-aluno='"+a.pivot.ds_nome_aluno+"' class='btn btn-outline-danger btn-sm btInscreverBolsaSocial'>Inscrevê-lo(a) para Bolsa Social</a>"):t="<a href='javascript:;' class='btFillAfterBolsa'>-</a>",s+="<tr style='font-size:12px'><td class='text-center'>"+a.pivot.ds_nome_aluno+"</td><td class='text-center'>"+a.nm_serie+" - "+a.ds_turno+"</td><td class='text-center'>"+t+"</td></tr>"}),s+="</tbody></table>",$("#listaFilhosInscritos").html(s),$("#agendamentosRealizados").html(""),Array.isArray(a.visitaInfo)?a.visitaInfo.map(function(a){$("#agendamentosRealizados").append("<tr><td class='text-center'>"+formatarDataParaWeb(a.dt_visita)+"</td><td class='text-center'>"+formatarHorarioParaWeb(a.hr_visita)+"</td></tr>")}):$("#agendamentosRealizados").append("<tr><td colspan='2' class='text-center'>Nenhum registro encontrado</td></tr>")}else $("#erroFormConsultaEmail").html("Nenhum registro encontrado")}).fail(function(a){console.log(a)}).always(function(o){e.prop("disabled",!1),a.hide()})}),$("#formVisitaAtu").on("submit",function(o){o.preventDefault();var t=$(this).serialize();e.prop("disabled",!0),a.show(),$.ajax({url:"./cadastrar-visita",type:"POST",dataType:"json",data:t+"&id_prematricula="+$("#idPrematricula").val()}).done(function(o){if(o.erro)o.erro&&$("#opsAgendamentoAtu").html('<small class="text-danger">'+o.mensagem+"</small>").show();else{var t=formatarDataParaWeb($("#data_visita").val()),s=formatarHorarioParaWeb($(".horario_visita").val());$("#opsAgendamentoAtu").html('<small class="text-success">Agendamento realizado com sucesso.</small>').show(),setTimeout(function(){$("#opsAgendamentoAtu").hide("slow")},1500),document.getElementById("formVisitaAtu").reset(),$("#agendamentosRealizados").prepend("<tr><td class='text-center'>"+t+"</td><td class='text-center'>"+s+"</td></tr>")}a.hide(),e.prop("disabled",!1)}).fail(function(o){$("#opsAgendamentoAtu").show(),a.hide(),e.prop("disabled",!1)})}),$("#formBolsaAtu").on("submit",function(o){$(".boxRendaAcima").hide(),o.preventDefault();var t=$("#nr_pessoas_familia_formBolsaAtu").val(),s=retirarPontoMoeda($("#ds_renda_familiar_formBolsaAtu").val());if(resultado=s/t,resultado<=2994){if($(".infoAcessoBolsa").show(),$("#senhaBolsa_formBolsaAtu").prop("required",!0),senhaBolsa=$("#senhaBolsa_formBolsaAtu").val(),validarCPF(senhaBolsa,"#retornoCpf_formBolsaAtu","#senhaBolsa_formBolsaAtu")&&""!=senhaBolsa){e.prop("disabled",!0),a.show();var n=$(this).serialize();$.ajax({url:"./cadastrar-bolsa",type:"POST",dataType:"json",data:n+"&id_prematricula="+$("#idPrematricula").val()}).done(function(o){o.erro?o.erro&&($(".opsBolsa").html('<small class="text-danger">'+o.mensagem+"</small>").show(),a.hide(),e.prop("disabled",!1)):(a.hide(),$(".opsBolsa").html('<small class="text-success">Cadastrado com sucesso.</small>').show(),setTimeout(function(){$(".boxBolsaSocialAtu").slideUp("slow"),$("#boxBolsaJaInscrito").fadeIn()},2e3),$(".btFillAfterBolsa").addClass("btn btn-sm btn-outline-success"),$(".btFillAfterBolsa").text("Já inscrito para Bolsa Social"),$("#idBolsa").val(o.id_bolsa),e.prop("disabled",!1))}).fail(function(o){$(".opsBolsa").show(),a.hide(),e.prop("disabled",!1)})}}else $(".boxRendaAcima").show(),a.hide(),e.prop("disabled",!1)}),$("#formAgendamentoDocumentoAtu").on("submit",function(o){o.preventDefault(),e.prop("disabled",!0),a.show();var t=$(this).serialize();$.ajax({url:"./cadastrar-agendamento-documento",type:"POST",dataType:"json",data:t+"&bolsa_id="+$("#idBolsa").val()}).done(function(o){if(o.erro)o.erro&&$(".opsAgendamentoDocAtu").html('<small class="text-danger">'+o.mensagem+"</small>").show();else{var t=formatarDataParaWeb(document.formAgendamentoDocumentoAtu.data.value),s=formatarHorarioParaWeb($(".horario_agend").val());$("#agendamentosRealizadosDocumento").prepend("<tr><td class='text-center'>"+t+"</td><td class='text-center'>"+s+"</td></tr>"),$(".opsAgendamentoDocAtu").html('<small class="text-success">Agendamento realizado com sucesso</small>').show(),setTimeout(function(){$(".opsAgendamentoDocAtu").hide("slow")},1500)}e.prop("disabled",!1),a.hide()}).fail(function(o){$(".opsAgendamentoDocAtu").show(),a.hide(),e.prop("disabled",!1)})})}),$(function(){var a="",e="",o=$(":submit"),t=$(".loader"),s=$(":submit"),n=$(":submit");$(".displayNone").hide(),$(".boxRendaAcima").hide(),$(".btCadPreinscricao").click(function(){$(".boxOptions").slideUp("slow"),$("#boxPreinscricao").fadeIn("slow"),$("#boxPreinscricaoAcomp").hide()}),$(".btTelaEscolha").click(function(){$(".boxOptions").fadeIn("slow"),$("#boxPreinscricao").hide(),$("#boxPreinscricaoAcomp").hide()}),$("#formPreinscricao").on("submit",function(a){a.preventDefault(),o.prop("disabled",!0),t.show(),$("#opsPreinscricao").hide();var e=$("#boxTbodyAlunoSerie input").val(),s=$("#boxTbodyAlunoSerie select").val();if(""==e||""==s)$("#retornoSeriesAlunos").text("Escolha pelo menos um aluno e série para continuar."),o.prop("disabled",!1),t.hide();else{var n=$(this).serialize();$.ajax({url:"./fazer-preinscricao",type:"POST",dataType:"json",data:n}).done(function(a){a.erro?a.erro&&($("#opsPreinscricao").html('<small class="text-danger">'+a.mensagem+"</small>").show(),t.hide(),o.prop("disabled",!1)):(o.prop("disabled",!1),t.hide(),$("#formPreinscricao").slideUp("slow"),$("#boxPreinscricaoConfirmada").show(),$("#boxSegundaParte").slideDown("slow"),$("#idPrematricula").val(a.id_prematricula),$(".loginBolsa").val($("#ds_email").val()))}).fail(function(a){$("#opsPreinscricao").show(),t.hide(),o.prop("disabled",!1)})}}),$("#formVisita").on("submit",function(a){a.preventDefault();var e=$(this).serialize();n.prop("disabled",!0),t.show(),$.ajax({url:"./cadastrar-visita",type:"POST",dataType:"json",data:e+"&id_prematricula="+$("#idPrematricula").val()}).done(function(a){a.erro?a.erro&&$(".opsAgendamento").html('<small class="text-danger">'+a.mensagem+"</small>").show():($("#boxAgendamento").slideUp("slow"),$("#boxAgendamentoConfirmado").show()),t.hide(),n.prop("disabled",!1)}).fail(function(a){$(".opsAgendamento").show(),t.hide(),n.prop("disabled",!1)})}),$("#formBolsa").on("submit",function(o){$(".boxRendaAcima").hide(),o.preventDefault();var n=$("#nr_pessoas_familia_formBolsa").val(),i=retirarPontoMoeda($("#ds_renda_familiar_formBolsa").val());if((e=i/n)<=2994){if($(".infoAcessoBolsa").show(),$("#senhaBolsa_formBolsa").prop("required",!0),a=$("#senhaBolsa_formBolsa").val(),validarCPF(a,"#retornoCpf_formBolsa","#senhaBolsa_formBolsa")&&""!=a){s.prop("disabled",!0),t.show();var r=$(this).serialize();$.ajax({url:"./cadastrar-bolsa",type:"POST",dataType:"json",data:r+"&id_prematricula="+$("#idPrematricula").val()}).done(function(a){a.erro?a.erro&&$(".opsBolsa").html('<small class="text-danger">'+a.mensagem+"</small>").show():($(".boxBolsaSocial").slideUp("slow"),$("#boxBolsaSocialConfirmado").show(),$("#idBolsa").val(a.id_bolsa)),t.hide(),s.prop("disabled",!1)}).fail(function(a){$(".opsBolsa").show(),t.hide(),s.prop("disabled",!1)})}}else $(".boxRendaAcima").show(),t.hide(),s.prop("disabled",!1)}),$("#formAgendamentoDocumento").on("submit",function(a){a.preventDefault();var e=$(this).serialize();$(".btAgendamentoDoc").prop("disabled",!0),t.show(),$.ajax({url:"./cadastrar-agendamento-documento",type:"POST",dataType:"json",data:e+"&bolsa_id="+$("#idBolsa").val()}).done(function(a){a.erro?a.erro&&($(".opsAgendamentoDoc").html('<small class="text-danger">'+a.mensagem+"</small>").show(),t.hide(),$(".btAgendamentoDoc").prop("disabled",!1)):($(".btAgendamentoDoc").prop("disabled",!1),t.hide(),$(".boxAgendamentoDoc").slideUp("slow"),$(".boxAgendamentoDocConfirmado").show())}).fail(function(a){$(".opsAgendamentoDoc").show(),t.hide(),$(".btAgendamentoDoc").prop("disabled",!1)})})});